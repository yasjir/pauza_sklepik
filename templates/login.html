<!DOCTYPE html>
<html lang="pl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<title>Sklepik Szkolny ‚Äî Logowanie</title>
<style>
@import url('https://fonts.googleapis.com/css2?family=Fredoka+One&family=Nunito:wght@400;600;700;800;900&display=swap');

* { box-sizing: border-box; margin: 0; padding: 0; -webkit-tap-highlight-color: transparent; }

body {
  font-family: 'Nunito', sans-serif;
  background: linear-gradient(135deg, #FF6B35 0%, #FF8C42 50%, #FFB347 100%);
  min-height: 100vh;
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 20px;
}

.login-card {
  background: white;
  border-radius: 28px;
  padding: 40px 32px;
  width: 100%;
  max-width: 380px;
  box-shadow: 0 24px 80px rgba(0,0,0,0.25);
}

.logo {
  text-align: center;
  margin-bottom: 32px;
}

.logo-icon {
  font-size: 4rem;
  display: block;
  margin-bottom: 8px;
}

.logo h1 {
  font-family: 'Fredoka One', cursive;
  font-size: 2rem;
  color: #FF6B35;
  letter-spacing: 1px;
}

.logo p {
  color: #95A5A6;
  font-size: 0.9rem;
  font-weight: 600;
  margin-top: 4px;
}

.fg {
  margin-bottom: 16px;
}

.fg label {
  display: block;
  font-weight: 800;
  font-size: 0.8rem;
  color: #95A5A6;
  margin-bottom: 6px;
  text-transform: uppercase;
  letter-spacing: 0.5px;
}

.fg input {
  width: 100%;
  padding: 14px 16px;
  border: 2px solid #F0E8E2;
  border-radius: 14px;
  font-family: 'Nunito', sans-serif;
  font-size: 1rem;
  font-weight: 700;
  outline: none;
  transition: border-color 0.2s;
  background: #FFF8F4;
}

.fg input:focus {
  border-color: #FF6B35;
  background: white;
}

.error-msg {
  background: #F8D7DA;
  color: #721c24;
  padding: 11px 16px;
  border-radius: 12px;
  font-weight: 700;
  font-size: 0.88rem;
  margin-bottom: 16px;
  text-align: center;
}

.btn-login {
  width: 100%;
  padding: 15px;
  background: linear-gradient(135deg, #FF6B35, #FF8C42);
  color: white;
  border: none;
  border-radius: 16px;
  font-family: 'Fredoka One', cursive;
  font-size: 1.2rem;
  cursor: pointer;
  letter-spacing: 0.5px;
  transition: all 0.2s;
  margin-top: 4px;
}

.btn-login:hover {
  transform: translateY(-2px);
  box-shadow: 0 8px 25px rgba(255,107,53,0.4);
}

.btn-login:active {
  transform: scale(0.97);
}

.btn-login:disabled {
  opacity: 0.6;
  cursor: not-allowed;
  transform: none;
}

.footer-note {
  text-align: center;
  margin-top: 24px;
  font-size: 0.8rem;
  color: #BDC3C7;
  font-weight: 600;
}
</style>
</head>
<body>
<div class="login-card">
  <div class="logo">
    <span class="logo-icon">üõí</span>
    <h1>Sklepik</h1>
    <p>Szkolny punkt sprzeda≈ºy</p>
  </div>

  {% if error %}
  <div class="error-msg">‚ùå {{ error }}</div>
  {% endif %}

  <form id="loginForm">
    <div class="fg">
      <label>Nazwa u≈ºytkownika</label>
      <input type="text" id="username" name="username" placeholder="np. admin"
             autocomplete="username" autocapitalize="none" required>
    </div>
    <div class="fg">
      <label>Has≈Ço</label>
      <input type="password" id="password" name="password" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢"
             autocomplete="current-password" required>
    </div>

    <div id="errorBox" class="error-msg" style="display:none"></div>

    <button type="submit" class="btn-login" id="btnLogin">üîê Zaloguj siƒô</button>
  </form>

  <p class="footer-note">Sklepik Szkolny v2.0</p>
</div>

<script>
document.getElementById('loginForm').addEventListener('submit', async (e) => {
  e.preventDefault();
  const btn = document.getElementById('btnLogin');
  const errBox = document.getElementById('errorBox');
  btn.disabled = true;
  btn.textContent = 'Logowanie...';
  errBox.style.display = 'none';

  const username = document.getElementById('username').value.trim();
  const password = document.getElementById('password').value;

  try {
    const res = await fetch('/login', {
      method: 'POST',
      headers: {'Content-Type': 'application/json'},
      body: JSON.stringify({username, password}),
    });

    if (res.ok) {
      window.location.href = '/app';
    } else {
      const data = await res.json();
      errBox.textContent = '‚ùå ' + (data.error || 'B≈ÇƒÖd logowania');
      errBox.style.display = 'block';
      btn.disabled = false;
      btn.textContent = 'üîê Zaloguj siƒô';
    }
  } catch (err) {
    errBox.textContent = '‚ùå B≈ÇƒÖd po≈ÇƒÖczenia z serwerem';
    errBox.style.display = 'block';
    btn.disabled = false;
    btn.textContent = 'üîê Zaloguj siƒô';
  }
});

// Focus na pierwsze pole
document.getElementById('username').focus();
</script>
</body>
</html>
